{% extends 'base/base.html' %}
{% load static %}

{% block extrastyle %}
    <link href="{% static 'lib/flatpickr/flatpickr.min.css' %}" rel="stylesheet">
    <link href="{% static 'lib/datatables-1.10.20/css/jquery.dataTables.css' %}" rel="stylesheet">
    <link rel="" href="https://cdn.datatables.net/fixedheader/3.1.6/css/fixedHeader.dataTables.min.css">
    <style>

        table{
            min-width: 100%;
            color: #2B2D42!important;
            background-color: #EDF2F9;
        }
    </style>
{% endblock %}

{% block body %}

    <div class="card mb-3 bg-card-gradient">
        <div class="card-body ">
            <div class="row justify-content-between align-items-center">
                <div class="col-md">
                    <h5 class="mb-2 mb-md-0 text-white">Conservación de patrimonios</h5>
                </div>
            </div>
        </div>
    </div>

    <div class="card mb-3">
        <div class="card-body">
            <div class="row filterBar">
                <div class="form-group col-sm-3">
                    <div class="position-relative">
                        <input class="form-control" id="name" type="text" placeholder="Nombre del proyecto">
                        <span class="fas fa-search inputIcon" data-fa-transform="shrink-3"></span>
                    </div>
                </div>
                <div class="form-group col-sm-2">
                    <select class="form-control" id="exampleFormControlSelect1">
                        <option>1</option>
                        <option>2</option>
                        <option>3</option>
                        <option>4</option>
                        <option>5</option>
                    </select>
                </div>
                <div class="form-group col-sm-2">
                    <select class="form-control" id="exampleFormControlSelect2">
                        <option>1</option>
                        <option>2</option>
                        <option>3</option>
                        <option>4</option>
                        <option>5</option>
                    </select>
                </div>
                <div class="form-group col-sm-2">
                    <select class="form-control" id="exampleFormControlSelect3">
                        <option>1</option>
                        <option>2</option>
                        <option>3</option>
                        <option>4</option>
                        <option>5</option>
                    </select>
                </div>
                <button class="btn btn-primary col-sm-3" type="button">
                    <span class="fas fa-plus mr-1" data-fa-transform="shrink-3"></span>Agregar Proyecto
                </button>
            </div>
        </div>
        <div class="card-body">
            <table id="tabla_autores" class="table">
                <thead>
                    <tr>
                        <th>Código</th>
                        <th>Nombre</th>
                        <th>Tipo de Plan</th>
                        <th>Actividades Completadas</th>
                        <th>Fecha de Registro</th>
                        <th>Estado</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody>

                </tbody>
            </table>
        </div>
    </div>

{% endblock %}

{% block extrajs %}
    <script src="{% static 'lib/flatpickr/flatpickr.min.js' %}"></script>
    <script src="{% static 'lib/datatables-1.10.20/js/jquery.dataTables.min.js' %}"></script>
    <script src="https://cdn.datatables.net/fixedheader/3.1.6/js/dataTables.fixedHeader.min.js"></script>
    <script>
        $(document).ready(function () {
            $('#tabla_autores').DataTable({
                "searching": false,
                "serverSide": true,
                "processing": true,
                "ajax": function (data, callback, settings) {
                    //var columna_filtro = data.columns[data.order[0].column].data.replace(/\./g,"__")
                    $.get('', {
                            limite: data.length,
                            inicio: data.start,
                            filtro:  $('#name').val()
                        }, function (res) {
                            callback({
                                recordsTotal: res.length,
                                recordsFiltered: res.length,
                                data: res.objects
                            });
                        },
                    );
                },
                "columns": [
                    {"data": "codigo"},
                    {"data": "nombre"},
                    {"data": "descripcion"},
                ]
            });
        });
        $('#name').keyup(function(){
            $('#tabla_autores').DataTable().search($(this).val()).draw() ;
        })
        $('#exampleFormControlSelect1').change(function(){
            $('#tabla_autores').DataTable().draw();
        });
        $('#exampleFormControlSelect2').change(function(){
            $('#tabla_autores').DataTable().draw();
        });
        $('#exampleFormControlSelect3').change(function(){
            $('#tabla_autores').DataTable().draw();
        });
</script>
{% endblock %}